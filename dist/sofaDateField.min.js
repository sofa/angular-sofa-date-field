/**
 * angular-sofa-date-field - v0.1.0 - Tue Feb 24 2015 12:31:20 GMT+0100 (CET)
 * http://www.sofa.io
 *
 * Copyright (c) 2014 CouchCommerce GmbH (http://www.couchcommerce.com / http://www.sofa.io) and other contributors
 * THIS SOFTWARE CONTAINS COMPONENTS OF THE SOFA.IO COUCHCOMMERCE SDK (WWW.SOFA.IO)
 * IT IS PROVIDED UNDER THE LICENSE TERMS OF THE ATTACHED LICENSE.TXT.
 */
!function(e){e.module("sofa.dateField",["sofa-date-field.tpl.html","sofa.localeService"]),e.module("sofa-date-field.tpl.html",[]).run(["$templateCache",function(e){e.put("sofa-date-field.tpl.html",'<div class="sofa-date-field">\n    <label for="{{fieldName}}_day" ng-bind="dateFieldCtrl.ln.day" class="sofa-hidden"></label>\n    <input type="text" id="{{fieldName}}_day" ng-model="innerModel.day"\n           class="sofa-date-field--day" placeholder="{{dateFieldCtrl.ln.placeholder.day}}"\n           sofa-name="fieldName + \'_day\'"\n           ng-required="isRequired" ng-pattern="/(^0[1-9]$)|(^[12][0-9]$)|(^3[01])/gm" maxlength="2"/>\n    <label for="{{fieldName}}_month" ng-bind="dateFieldCtrl.ln.month" class="sofa-hidden"></label>\n    <input type="text" id="{{fieldName}}_month" ng-model="innerModel.month"\n           class="sofa-date-field--month" placeholder="{{dateFieldCtrl.ln.placeholder.month}}"\n           sofa-name="fieldName + \'_month\'"\n           ng-required="isRequired" ng-pattern="/(^0[1-9]$)|(^1[0-2]$)/gm" maxlength="2" />\n    <label for="{{fieldName}}_year" ng-bind="dateFieldCtrl.ln.year" class="sofa-hidden"></label>\n    <input type="text" id="{{fieldName}}_year" ng-model="innerModel.year"\n           class="sofa-date-field--year" placeholder="{{dateFieldCtrl.ln.placeholder.year}}"\n           sofa-name="fieldName + \'_year\'"\n           ng-required="isRequired" maxlength="4" />\n</div>\n')}]),e.module("sofa.dateField").controller("sofaDateFieldController",["localeService",function(e){"use strict";this.ln=e.getTranslation("sofaDateField")}]),e.module("sofa.dateField").directive("sofaDateField",["sofaDateFieldService",function(e){"use strict";return{restrict:"E",replace:!0,scope:{fieldName:"=",isRequired:"=",model:"=ngModel"},controller:"sofaDateFieldController",controllerAs:"dateFieldCtrl",bindToController:!0,require:["ngModel"],templateUrl:"sofa-date-field.tpl.html",link:function(t,l,a,n){var d=n[0];d.$name=t.fieldName,d.$parsers.unshift(function(t){return e.getDatRegEx().test(t)?(d.$setValidity("sofaDate",!0),t):void d.$setValidity("sofaDate",!1)}),t.innerModel={day:"",month:"",year:""},t.$watch("innerModel",function(l,a){l&&l!==a&&(t.model=e.getUpdatedModel(l),e.updateModelController(d,l))},!0),t.$watch("model",function(l){l&&e.isSuitableModel(l)&&(t.innerModel=e.splitModel(l))})}}}]),e.module("sofa.dateField").factory("sofaDateFieldService",function(){"use strict";var e=/^[1-9][0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])/,t=this;return t.getDatRegEx=function(){return e},t.splitModel=function(e){var t=e.split("-");return{day:t[2],month:t[1],year:t[0]}},t.isSuitableModel=function(t){return t&&t.match(e)},t.getDateString=function(e){return e.year+"-"+e.month+"-"+e.day},t.getUpdatedModel=function(e){return t.getDateString(e)},t.updateModelController=function(e,l){e.$setViewValue(t.getDateString(l))},t})}(angular);